{"version":3,"file":"index.esm.js","sources":["../src/utils/attachEventProps.ts","../src/utils/index.tsx","../src/createComponent.tsx","../src/index.ts"],"sourcesContent":["export const attachEventProps = (\n  node: HTMLElement,\n  newProps: any,\n  oldProps: any = {}\n) => {\n  // add any classes in className to the class list\n  const className = getClassName(node.classList, newProps, oldProps);\n  if (className !== \"\") {\n    node.className = className;\n  }\n\n  Object.keys(newProps).forEach((name) => {\n    if (\n      name === \"children\" ||\n      name === \"style\" ||\n      name === \"ref\" ||\n      name === \"className\"\n    ) {\n      return;\n    }\n    if (name.indexOf(\"on\") === 0 && name[2] === name[2].toUpperCase()) {\n      const eventName = name.substring(2);\n      const eventNameLc = eventName[0].toLowerCase() + eventName.substring(1);\n\n      if (!isCoveredByReact(eventNameLc)) {\n        syncEvent(node, eventNameLc, newProps[name]);\n      }\n    } else {\n      (node as any)[name] = newProps[name];\n    }\n  });\n};\n\nexport const getClassName = (\n  classList: DOMTokenList,\n  newProps: any,\n  oldProps: any\n) => {\n  const newClassProp: string = newProps.className || newProps.class;\n  const oldClassProp: string = oldProps.className || oldProps.class;\n  // map the classes to Maps for performance\n  const currentClasses = arrayToMap(classList);\n  // tslint:disable-next-line: strict-boolean-conditions\n  const incomingPropClasses = arrayToMap(\n    newClassProp ? newClassProp.split(\" \") : []\n  );\n  // tslint:disable-next-line: strict-boolean-conditions\n  const oldPropClasses = arrayToMap(\n    oldClassProp ? oldClassProp.split(\" \") : []\n  );\n  const finalClassNames: string[] = [];\n  // loop through each of the current classes on the component\n  // to see if it should be a part of the classNames added\n  currentClasses.forEach((currentClass) => {\n    if (incomingPropClasses.has(currentClass)) {\n      // add it as its already included in classnames coming in from newProps\n      finalClassNames.push(currentClass);\n      incomingPropClasses.delete(currentClass);\n    } else if (!oldPropClasses.has(currentClass)) {\n      // add it as it has NOT been removed by user\n      finalClassNames.push(currentClass);\n    }\n  });\n  incomingPropClasses.forEach((s) => finalClassNames.push(s));\n  return finalClassNames.join(\" \");\n};\n\n/**\n * Checks if an event is supported in the current execution environment.\n * @license Modernizr 3.0.0pre (Custom Build) | MIT\n */\nexport const isCoveredByReact = (\n  eventNameSuffix: string,\n  doc: Document = document\n) => {\n  const eventName = \"on\" + eventNameSuffix;\n  let isSupported = eventName in doc;\n\n  if (!isSupported) {\n    const element = doc.createElement(\"div\");\n    element.setAttribute(eventName, \"return;\");\n    isSupported = typeof (element as any)[eventName] === \"function\";\n  }\n\n  return isSupported;\n};\n\nexport const syncEvent = (\n  node: Element,\n  eventName: string,\n  newEventHandler: (e: Event) => any\n) => {\n  const eventStore = (node as any).__events || ((node as any).__events = {});\n  const oldEventHandler = eventStore[eventName];\n\n  // Remove old listener so they don't double up.\n  if (oldEventHandler) {\n    node.removeEventListener(eventName, oldEventHandler);\n  }\n\n  // Bind new listener.\n  node.addEventListener(\n    eventName,\n    (eventStore[eventName] = function handler(e: Event) {\n      newEventHandler.call(this, e);\n    })\n  );\n};\n\nconst arrayToMap = (arr: string[] | DOMTokenList) => {\n  const map = new Map<string, string>();\n  (arr as string[]).forEach((s: string) => map.set(s, s));\n  return map;\n};\n","import React from \"react\";\nexport const dashToPascalCase = (str: string) =>\n  str\n    .toLowerCase()\n    .split(\"-\")\n    .map((segment) => segment.charAt(0).toUpperCase() + segment.slice(1))\n    .join(\"\");\n\nexport type NeoReactExternalProps<PropType, ElementType> = PropType & {\n  ref?: React.RefObject<ElementType>;\n  children?: React.ReactNode;\n};\n\nexport const createForwardRef = <PropType, ElementType>(\n  ReactComponent: any,\n  displayName: string\n) => {\n  const forwardRef = (\n    props: NeoReactExternalProps<PropType, ElementType>,\n    ref: React.Ref<ElementType>\n  ) => {\n    return <ReactComponent {...props} forwardedRef={ref} />;\n  };\n  forwardRef.displayName = displayName;\n\n  return React.forwardRef(forwardRef);\n};\n\nexport * from \"./attachEventProps\";\n","import React from \"react\";\nimport ReactDom from \"react-dom\";\n\nimport {\n  attachEventProps,\n  createForwardRef,\n  dashToPascalCase,\n  isCoveredByReact,\n} from \"./utils\";\n\nexport interface ReactProps {\n  className?: string;\n}\n\ninterface ReactInternalProps<ElementType> {\n  forwardedRef?: React.Ref<ElementType>;\n  children?: React.ReactNode;\n  href?: string;\n  target?: string;\n  style?: string;\n  ref?: React.Ref<any>;\n  className?: string;\n}\n\nexport const createReactComponent = <PropType, ElementType>(\n  tagName: string\n) => {\n  const displayName = dashToPascalCase(tagName);\n  const ReactComponent = class extends React.Component<\n    ReactInternalProps<ElementType>\n  > {\n    constructor(props: ReactInternalProps<ElementType>) {\n      super(props);\n    }\n\n    componentDidMount() {\n      const node = ReactDom.findDOMNode(this) as HTMLElement;\n      attachEventProps(node, this.props, this.props);\n    }\n\n    componentDidUpdate(prevProps: ReactInternalProps<ElementType>) {\n      if (prevProps !== this.props) {\n        const node = ReactDom.findDOMNode(this) as HTMLElement;\n        attachEventProps(node, this.props, prevProps);\n      }\n    }\n\n    render() {\n      const {\n        children,\n        forwardedRef,\n        style,\n        className,\n        ref,\n        ...cProps\n      } = this.props;\n\n      const propsToPass = Object.keys(cProps).reduce((acc, name) => {\n        if (name.indexOf(\"on\") === 0 && name[2] === name[2].toUpperCase()) {\n          const eventName = name.substring(2).toLowerCase();\n          if (isCoveredByReact(eventName)) {\n            (acc as any)[name] = (cProps as any)[name];\n          }\n        }\n        return acc;\n      }, {});\n\n      const newProps: any = {\n        ...propsToPass,\n        ref: forwardedRef,\n        style,\n      };\n\n      return React.createElement(tagName, newProps, children);\n    }\n\n    static get displayName() {\n      return displayName;\n    }\n  };\n  return createForwardRef<PropType & ReactProps, ElementType>(\n    ReactComponent,\n    displayName\n  );\n};\n","import { JSX } from \"k-ui-kit\";\nimport { defineCustomElements } from \"k-ui-kit/loader\";\nimport { createReactComponent } from \"./createComponent\";\n\nexport const MyComponent = /*@\\__PURE_\\_*/ createReactComponent<\n  JSX.MyComponent,\n  HTMLMyComponentElement\n>(\"my-component\");\n\nexport const KButton = /*@\\__PURE_\\_*/ createReactComponent<\n  JSX.KButton,\n  HTMLKButtonElement\n>(\"k-button\");\n\nexport const KSpinner = /*@\\__PURE_\\_*/ createReactComponent<\n  JSX.KSpinner,\n  HTMLKSpinnerElement\n>(\"k-spinner\");\n\ndefineCustomElements(window);\n"],"names":[],"mappings":"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"}